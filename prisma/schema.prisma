generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://postgres:zizo18889@localhost:5432/Kitchenly"
}

model User {
  id                       String                                @id @default(cuid())
  profileImage             String?
  name                     String
  email                    String                                @unique
  password                 String
  nationalId               String?
  location                 Unsupported("geography(Point,4326)")?
  age                      Int?
  role                     Role                                  @default(CUSTOMER)
  createdAt                DateTime                              @default(now())
  updatedAt                DateTime                              @updatedAt
  passwordUpdatedAt        DateTime?
  passwordResetToken       String?                               @unique
  passwordResetTokenExpiry DateTime?

  menuItems      MenuItem[]
  chefOrders     Order[]    @relation("ChefOrders")
  customerOrders Order[]    @relation("CustomerOrders")
}

model MenuItem {
  id          String      @id @default(cuid())
  name        String
  image       String?
  description String
  price       Float
  foodType    FoodType
  itemType    ItemType
  chef_id     String
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  slug        String?
  chef        User        @relation(fields: [chef_id], references: [id], onDelete: Cascade)
  orderitem   OrderItem[]
}

model Order {
  id              String      @id @default(cuid())
  image           String?
  customer_id     String
  chef_id         String
  order_status    OrderStatus @default(PENDING)
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
  total_price     Float
  paymentIntentId String?
  paymentStatus   String?
  chef            User        @relation("ChefOrders", fields: [chef_id], references: [id], onDelete: Cascade)
  customer        User        @relation("CustomerOrders", fields: [customer_id], references: [id], onDelete: Cascade)
  orderitems      OrderItem[]

  @@index([customer_id])
  @@index([chef_id])
}

model OrderItem {
  id          String   @id @default(cuid())
  order_id    String
  menuitem_id String
  quantity    Int
  item_price  Float
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  menuitem    MenuItem @relation(fields: [menuitem_id], references: [id], onDelete: Cascade)
  order       Order    @relation(fields: [order_id], references: [id], onDelete: Cascade)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model spatial_ref_sys {
  srid      Int     @id
  auth_name String? @db.VarChar(256)
  auth_srid Int?
  srtext    String? @db.VarChar(2048)
  proj4text String? @db.VarChar(2048)
}

enum Role {
  ADMIN
  CHEF
  CUSTOMER
}

enum FoodType {
  MIDDLE_EASTERN
  LEBANESE
  TURKISH
  PERSIAN
  EGYPTIAN
  ARABIAN
  PALESTINIAN
  CHINESE
  JAPANESE
  KOREAN
  TAIWANESE
  MONGOLIAN
  THAI
  VIETNAMESE
  FILIPINO
  MALAYSIAN
  INDONESIAN
  SINGAPOREAN
  INDIAN
  PAKISTANI
  BANGLADESHI
  SRI_LANKAN
  NEPALI
  ITALIAN
  FRENCH
  SPANISH
  PORTUGUESE
  GREEK
  GERMAN
  BRITISH
  SCANDINAVIAN
  RUSSIAN
  EASTERN_EUROPEAN
  AMERICAN
  CANADIAN
  MEXICAN
  BRAZILIAN
  ARGENTINIAN
  CARIBBEAN
  NORTH_AFRICAN
  ETHIOPIAN
  MOROCCAN
  WEST_AFRICAN
  SOUTH_AFRICAN
  FAST_FOOD
  VEGAN
  VEGETARIAN
  FUSION
  STREET_FOOD
  SEAFOOD
  BBQ
  GRILLED
  DESSERT
  SNACK
}

enum ItemType {
  MAINDISH
  DRINK
  DESSERT
  BEVERAGE
}

enum OrderStatus {
  PENDING
  ACCEPTED
  DECLINED
  COOKING
  DONE
}
